[ 2025-01-14 19:48:53,390 ] 160 numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[ 2025-01-14 19:48:54,991 ] 20 root - INFO - Entered the start_data_ingestion of the TrainPipeline Class
[ 2025-01-14 19:48:54,992 ] 21 root - INFO - Getting the data from MongoDB
[ 2025-01-14 19:48:54,992 ] 55 root - INFO - Initiating Data Ingestion
[ 2025-01-14 19:48:54,992 ] 23 root - INFO - Exporting data into MongoDb
[ 2025-01-14 19:48:55,368 ] 29 root - INFO - Database connection is successful
[ 2025-01-14 19:49:03,503 ] 26 root - INFO - Shape of the dataset: (25480, 12)
[ 2025-01-14 19:49:03,504 ] 30 root - INFO - Saving exported data into feature store file path: artifact/01_14_2025_19_48_54/data_ingestion/feature_store/usvisa.csv
[ 2025-01-14 19:49:03,599 ] 59 root - INFO - Got the data from MongoDB
[ 2025-01-14 19:49:03,599 ] 37 root - INFO - Entered split_data_as_train_and_test method of the Data Ingestion class
[ 2025-01-14 19:49:03,604 ] 41 root - INFO - Split the data frame successfully
[ 2025-01-14 19:49:03,605 ] 47 root - INFO - Exporting the data frame into train and test data frames
[ 2025-01-14 19:49:03,697 ] 50 root - INFO - Exported the data frame into train and test datasets
[ 2025-01-14 19:49:03,698 ] 63 root - INFO - Executed the train-test split
[ 2025-01-14 19:49:03,698 ] 64 root - INFO - Exited initiate_data_ingestion method of DataIngestion class
[ 2025-01-14 19:49:03,698 ] 71 root - INFO - Data ingestion artifact: DataIngestionArtifact(trained_file_path='artifact/01_14_2025_19_48_54/data_ingestion/ingested/train.csv', test_file_path='artifact/01_14_2025_19_48_54/data_ingestion/ingested/test.csv')
[ 2025-01-14 19:49:03,703 ] 24 root - INFO - Got the train and the test set from MongoDB
[ 2025-01-14 19:49:03,703 ] 25 root - INFO - Excited about the Data Ingestion workflow
[ 2025-01-14 19:49:03,703 ] 31 root - INFO - Entered the start_data_validation of the TrainPipeline Class
[ 2025-01-14 19:49:03,706 ] 101 root - INFO - Started the Data Validation flow
[ 2025-01-14 19:49:03,743 ] 110 root - INFO - Training DataFrame shape: (20384, 12)
[ 2025-01-14 19:49:03,743 ] 111 root - INFO - Testing DataFrame shape: (5096, 12)
[ 2025-01-14 19:49:03,743 ] 28 root - INFO - Is required column present: True
[ 2025-01-14 19:49:03,743 ] 115 root - INFO - All required columns present in training dataframe: True
[ 2025-01-14 19:49:03,743 ] 28 root - INFO - Is required column present: True
[ 2025-01-14 19:49:03,743 ] 120 root - INFO - All required columns present in testing dataframe: True
[ 2025-01-14 19:49:03,744 ] 91 root - INFO - No drift detected in numerical columns.
[ 2025-01-14 19:49:03,744 ] 150 root - INFO - Data validation artifact: DataValidationArtifact(validation_status=True, message='Drift not detected', drift_report_file_path='artifact/01_14_2025_19_48_54/data_validation/drift_report/report.yaml')
[ 2025-01-14 19:49:03,745 ] 38 root - INFO - Performed the data validation operation
[ 2025-01-14 19:49:03,745 ] 39 root - INFO - Exited the start_data_validation method of TrainPipeline class
[ 2025-01-14 19:49:03,745 ] 45 root - INFO - Entered the start_data_transformation of the TrainPipeline Class
[ 2025-01-14 19:49:03,748 ] 76 root - INFO - Starting data transformation.
[ 2025-01-14 19:49:03,748 ] 42 root - INFO - Entered the data transformer object creation.
[ 2025-01-14 19:49:03,748 ] 56 root - INFO - Setting up ColumnTransformer.
[ 2025-01-14 19:49:03,748 ] 66 root - INFO - Preprocessor object created successfully.
[ 2025-01-14 19:49:03,783 ] 82 root - INFO - Splitting input and target features for train and test datasets.
[ 2025-01-14 19:49:03,786 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-14 19:49:03,787 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-14 19:49:03,788 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-14 19:49:03,788 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-14 19:49:05,418 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-14 19:49:05,423 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-14 19:49:05,426 ] 128 root - INFO - Data transformation completed successfully.
[ 2025-01-14 19:49:05,429 ] 53 root - INFO - Started the data transformation operation
[ 2025-01-14 19:49:05,429 ] 54 root - INFO - Exited the start_data_transformation method of TrainPipeline class
[ 2025-01-14 19:49:05,429 ] 62 root - INFO - Entered initiate_model_trainer method of ModelTrainer class
[ 2025-01-14 19:49:05,431 ] 37 root - INFO - Using neuro_mf to get best model object and report
[ 2025-01-14 19:49:05,436 ] 242 neuro_mf - INFO - Started Initializing model from config file
[ 2025-01-14 19:49:05,436 ] 59 neuro_mf - INFO - {'algorithm': 'kd_tree', 'weights': 'uniform', 'n_neighbors': 3}
[ 2025-01-14 19:49:05,437 ] 59 neuro_mf - INFO - {'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3}
[ 2025-01-14 19:49:05,438 ] 244 neuro_mf - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), param_grid_search={'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'weights': ['uniform', 'distance'], 'n_neighbors': [3, 5, 9]}, model_name='sklearn.neighbors.KNeighborsClassifier'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(max_depth=10, n_estimators=3), param_grid_search={'max_depth': [10, 15, 20], 'max_features': ['sqrt', 'log2'], 'n_estimators': [3, 5, 9]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[ 2025-01-14 19:49:05,439 ] 106 neuro_mf - INFO - ('**************************************************', 'training KNeighborsClassifier', '**************************************************')
[ 2025-01-14 19:49:05,439 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-14 19:49:25,427 ] 106 neuro_mf - INFO - ('**************************************************', 'training RandomForestClassifier', '**************************************************')
[ 2025-01-14 19:49:25,428 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-14 19:49:29,043 ] 223 neuro_mf - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.95656259034403)
[ 2025-01-14 19:49:29,043 ] 229 neuro_mf - INFO - Best model: GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.95656259034403)
[ 2025-01-14 19:49:29,098 ] 37 root - INFO - Entered the load object method of Utils
[ 2025-01-14 19:49:29,099 ] 41 root - INFO - Exited the load object from the method utils
[ 2025-01-14 19:49:29,099 ] 85 root - INFO - Created usvisa model object with preprocessor and model
[ 2025-01-14 19:49:29,099 ] 86 root - INFO - Created best model file path.
[ 2025-01-14 19:49:29,099 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-14 19:49:29,102 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-14 19:49:29,102 ] 93 root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='artifact/01_14_2025_19_48_54/model_trainer/trained_model/model.pkl', metric_artifact=ClassificationMetricArtifact(f1_score=0.8169668797210924, precision_score=0.8379022646007152, recall_score=0.7970521541950113))
