[ 2025-01-15 12:11:55,764 ] 160 numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[ 2025-01-15 12:11:57,217 ] 86 root - INFO - Starting the training pipeline.
[ 2025-01-15 12:11:57,218 ] 22 root - INFO - Starting data ingestion phase of the TrainPipeline.
[ 2025-01-15 12:11:57,218 ] 55 root - INFO - Initiating Data Ingestion
[ 2025-01-15 12:11:57,218 ] 23 root - INFO - Exporting data into MongoDb
[ 2025-01-15 12:11:59,488 ] 29 root - INFO - Database connection is successful
[ 2025-01-15 12:12:11,234 ] 26 root - INFO - Shape of the dataset: (25480, 12)
[ 2025-01-15 12:12:11,235 ] 30 root - INFO - Saving exported data into feature store file path: artifact/01_15_2025_12_11_56/data_ingestion/feature_store/usvisa.csv
[ 2025-01-15 12:12:11,331 ] 59 root - INFO - Got the data from MongoDB
[ 2025-01-15 12:12:11,331 ] 37 root - INFO - Entered split_data_as_train_and_test method of the Data Ingestion class
[ 2025-01-15 12:12:11,336 ] 41 root - INFO - Split the data frame successfully
[ 2025-01-15 12:12:11,336 ] 47 root - INFO - Exporting the data frame into train and test data frames
[ 2025-01-15 12:12:11,429 ] 50 root - INFO - Exported the data frame into train and test datasets
[ 2025-01-15 12:12:11,430 ] 63 root - INFO - Executed the train-test split
[ 2025-01-15 12:12:11,430 ] 64 root - INFO - Exited initiate_data_ingestion method of DataIngestion class
[ 2025-01-15 12:12:11,430 ] 71 root - INFO - Data ingestion artifact: DataIngestionArtifact(trained_file_path='artifact/01_15_2025_12_11_56/data_ingestion/ingested/train.csv', test_file_path='artifact/01_15_2025_12_11_56/data_ingestion/ingested/test.csv')
[ 2025-01-15 12:12:11,435 ] 25 root - INFO - Data ingestion completed successfully.
[ 2025-01-15 12:12:11,436 ] 32 root - INFO - Starting data validation phase of the TrainPipeline.
[ 2025-01-15 12:12:11,438 ] 101 root - INFO - Started the Data Validation flow
[ 2025-01-15 12:12:11,472 ] 110 root - INFO - Training DataFrame shape: (20384, 12)
[ 2025-01-15 12:12:11,473 ] 111 root - INFO - Testing DataFrame shape: (5096, 12)
[ 2025-01-15 12:12:11,473 ] 28 root - INFO - Is required column present: True
[ 2025-01-15 12:12:11,473 ] 115 root - INFO - All required columns present in training dataframe: True
[ 2025-01-15 12:12:11,473 ] 28 root - INFO - Is required column present: True
[ 2025-01-15 12:12:11,473 ] 120 root - INFO - All required columns present in testing dataframe: True
[ 2025-01-15 12:12:11,474 ] 91 root - INFO - No drift detected in numerical columns.
[ 2025-01-15 12:12:11,474 ] 150 root - INFO - Data validation artifact: DataValidationArtifact(validation_status=True, message='Drift not detected', drift_report_file_path='artifact/01_15_2025_12_11_56/data_validation/drift_report/report.yaml')
[ 2025-01-15 12:12:11,475 ] 38 root - INFO - Data validation completed successfully.
[ 2025-01-15 12:12:11,475 ] 45 root - INFO - Starting data transformation phase of the TrainPipeline.
[ 2025-01-15 12:12:11,477 ] 76 root - INFO - Starting data transformation.
[ 2025-01-15 12:12:11,477 ] 42 root - INFO - Entered the data transformer object creation.
[ 2025-01-15 12:12:11,477 ] 56 root - INFO - Setting up ColumnTransformer.
[ 2025-01-15 12:12:11,478 ] 66 root - INFO - Preprocessor object created successfully.
[ 2025-01-15 12:12:11,513 ] 82 root - INFO - Splitting input and target features for train and test datasets.
[ 2025-01-15 12:12:11,515 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-15 12:12:11,517 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-15 12:12:11,517 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-15 12:12:11,518 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-15 12:12:13,267 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-15 12:12:13,274 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-15 12:12:13,276 ] 128 root - INFO - Data transformation completed successfully.
[ 2025-01-15 12:12:13,280 ] 52 root - INFO - Data transformation completed successfully.
[ 2025-01-15 12:12:13,280 ] 59 root - INFO - Starting model training phase of the TrainPipeline.
[ 2025-01-15 12:12:13,280 ] 62 root - INFO - Entered initiate_model_trainer method of ModelTrainer class
[ 2025-01-15 12:12:13,282 ] 37 root - INFO - Using neuro_mf to get best model object and report
[ 2025-01-15 12:12:13,287 ] 242 neuro_mf - INFO - Started Initializing model from config file
[ 2025-01-15 12:12:13,287 ] 59 neuro_mf - INFO - {'algorithm': 'kd_tree', 'weights': 'uniform', 'n_neighbors': 3}
[ 2025-01-15 12:12:13,287 ] 59 neuro_mf - INFO - {'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3}
[ 2025-01-15 12:12:13,289 ] 244 neuro_mf - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), param_grid_search={'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'weights': ['uniform', 'distance'], 'n_neighbors': [3, 5, 9]}, model_name='sklearn.neighbors.KNeighborsClassifier'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(max_depth=10, n_estimators=3), param_grid_search={'max_depth': [10, 15, 20], 'max_features': ['sqrt', 'log2'], 'n_estimators': [3, 5, 9]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[ 2025-01-15 12:12:13,289 ] 106 neuro_mf - INFO - ('**************************************************', 'training KNeighborsClassifier', '**************************************************')
[ 2025-01-15 12:12:13,289 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-15 12:12:33,863 ] 106 neuro_mf - INFO - ('**************************************************', 'training RandomForestClassifier', '**************************************************')
[ 2025-01-15 12:12:33,864 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-15 12:12:37,433 ] 223 neuro_mf - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9575909313220335)
[ 2025-01-15 12:12:37,433 ] 229 neuro_mf - INFO - Best model: GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9575909313220335)
[ 2025-01-15 12:12:37,489 ] 37 root - INFO - Entered the load object method of Utils
[ 2025-01-15 12:12:37,491 ] 41 root - INFO - Exited the load object from the method utils
[ 2025-01-15 12:12:37,491 ] 85 root - INFO - Created usvisa model object with preprocessor and model
[ 2025-01-15 12:12:37,491 ] 86 root - INFO - Created best model file path.
[ 2025-01-15 12:12:37,491 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-15 12:12:37,494 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-15 12:12:37,494 ] 93 root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='artifact/01_15_2025_12_11_56/model_trainer/trained_model/model.pkl', metric_artifact=ClassificationMetricArtifact(f1_score=0.826597879048438, precision_score=0.842781998831093, recall_score=0.8110236220472441))
[ 2025-01-15 12:12:37,495 ] 65 root - INFO - Model training completed successfully.
[ 2025-01-15 12:12:37,495 ] 72 root - INFO - Starting model evaluation phase of the TrainPipeline.
[ 2025-01-15 12:12:37,510 ] 37 root - INFO - Entered the load object method of Utils
[ 2025-01-15 12:12:37,511 ] 41 root - INFO - Exited the load object from the method utils
[ 2025-01-15 12:12:37,511 ] 34 root - INFO - Entered predict method of UTruckModel class
[ 2025-01-15 12:12:37,511 ] 37 root - INFO - Using the trained model to get predictions
[ 2025-01-15 12:12:37,527 ] 41 root - INFO - Used the trained model to get predictions
[ 2025-01-15 12:12:37,786 ] 100 root - ERROR - Error occurred during the training pipeline.
