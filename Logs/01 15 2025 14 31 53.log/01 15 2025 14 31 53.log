[ 2025-01-15 14:31:53,652 ] 160 numexpr.utils - INFO - NumExpr defaulting to 8 threads.
[ 2025-01-15 14:31:55,243 ] 84 root - INFO - Starting the training pipeline.
[ 2025-01-15 14:31:55,243 ] 20 root - INFO - Starting data ingestion phase of the TrainPipeline.
[ 2025-01-15 14:31:55,243 ] 55 root - INFO - Initiating Data Ingestion
[ 2025-01-15 14:31:55,243 ] 23 root - INFO - Exporting data into MongoDb
[ 2025-01-15 14:31:55,478 ] 29 root - INFO - Database connection is successful
[ 2025-01-15 14:32:05,123 ] 26 root - INFO - Shape of the dataset: (25480, 12)
[ 2025-01-15 14:32:05,124 ] 30 root - INFO - Saving exported data into feature store file path: artifact/01_15_2025_14_31_54/data_ingestion/feature_store/usvisa.csv
[ 2025-01-15 14:32:05,220 ] 59 root - INFO - Got the data from MongoDB
[ 2025-01-15 14:32:05,220 ] 37 root - INFO - Entered split_data_as_train_and_test method of the Data Ingestion class
[ 2025-01-15 14:32:05,225 ] 41 root - INFO - Split the data frame successfully
[ 2025-01-15 14:32:05,226 ] 47 root - INFO - Exporting the data frame into train and test data frames
[ 2025-01-15 14:32:05,325 ] 50 root - INFO - Exported the data frame into train and test datasets
[ 2025-01-15 14:32:05,327 ] 63 root - INFO - Executed the train-test split
[ 2025-01-15 14:32:05,327 ] 64 root - INFO - Exited initiate_data_ingestion method of DataIngestion class
[ 2025-01-15 14:32:05,327 ] 71 root - INFO - Data ingestion artifact: DataIngestionArtifact(trained_file_path='artifact/01_15_2025_14_31_54/data_ingestion/ingested/train.csv', test_file_path='artifact/01_15_2025_14_31_54/data_ingestion/ingested/test.csv')
[ 2025-01-15 14:32:05,333 ] 23 root - INFO - Data ingestion completed successfully.
[ 2025-01-15 14:32:05,333 ] 30 root - INFO - Starting data validation phase of the TrainPipeline.
[ 2025-01-15 14:32:05,335 ] 101 root - INFO - Started the Data Validation flow
[ 2025-01-15 14:32:05,373 ] 110 root - INFO - Training DataFrame shape: (20384, 12)
[ 2025-01-15 14:32:05,373 ] 111 root - INFO - Testing DataFrame shape: (5096, 12)
[ 2025-01-15 14:32:05,374 ] 28 root - INFO - Is required column present: True
[ 2025-01-15 14:32:05,374 ] 115 root - INFO - All required columns present in training dataframe: True
[ 2025-01-15 14:32:05,374 ] 28 root - INFO - Is required column present: True
[ 2025-01-15 14:32:05,374 ] 120 root - INFO - All required columns present in testing dataframe: True
[ 2025-01-15 14:32:05,375 ] 91 root - INFO - No drift detected in numerical columns.
[ 2025-01-15 14:32:05,376 ] 150 root - INFO - Data validation artifact: DataValidationArtifact(validation_status=True, message='Drift not detected', drift_report_file_path='artifact/01_15_2025_14_31_54/data_validation/drift_report/report.yaml')
[ 2025-01-15 14:32:05,376 ] 36 root - INFO - Data validation completed successfully.
[ 2025-01-15 14:32:05,377 ] 43 root - INFO - Starting data transformation phase of the TrainPipeline.
[ 2025-01-15 14:32:05,379 ] 76 root - INFO - Starting data transformation.
[ 2025-01-15 14:32:05,379 ] 42 root - INFO - Entered the data transformer object creation.
[ 2025-01-15 14:32:05,380 ] 56 root - INFO - Setting up ColumnTransformer.
[ 2025-01-15 14:32:05,380 ] 66 root - INFO - Preprocessor object created successfully.
[ 2025-01-15 14:32:05,416 ] 82 root - INFO - Splitting input and target features for train and test datasets.
[ 2025-01-15 14:32:05,419 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-15 14:32:05,420 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-15 14:32:05,420 ] 83 root - INFO - Entered drop column of the Utils
[ 2025-01-15 14:32:05,421 ] 86 root - INFO - Exited the drop columns of the method Utils
[ 2025-01-15 14:32:07,190 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-15 14:32:07,195 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-15 14:32:07,197 ] 128 root - INFO - Data transformation completed successfully.
[ 2025-01-15 14:32:07,201 ] 50 root - INFO - Data transformation completed successfully.
[ 2025-01-15 14:32:07,201 ] 57 root - INFO - Starting model training phase of the TrainPipeline.
[ 2025-01-15 14:32:07,201 ] 62 root - INFO - Entered initiate_model_trainer method of ModelTrainer class
[ 2025-01-15 14:32:07,202 ] 37 root - INFO - Using neuro_mf to get best model object and report
[ 2025-01-15 14:32:07,207 ] 242 neuro_mf - INFO - Started Initializing model from config file
[ 2025-01-15 14:32:07,208 ] 59 neuro_mf - INFO - {'algorithm': 'kd_tree', 'weights': 'uniform', 'n_neighbors': 3}
[ 2025-01-15 14:32:07,208 ] 59 neuro_mf - INFO - {'max_depth': 10, 'max_features': 'sqrt', 'n_estimators': 3}
[ 2025-01-15 14:32:07,209 ] 244 neuro_mf - INFO - Initialized model: [InitializedModelDetail(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), param_grid_search={'algorithm': ['auto', 'ball_tree', 'kd_tree', 'brute'], 'weights': ['uniform', 'distance'], 'n_neighbors': [3, 5, 9]}, model_name='sklearn.neighbors.KNeighborsClassifier'), InitializedModelDetail(model_serial_number='module_1', model=RandomForestClassifier(max_depth=10, n_estimators=3), param_grid_search={'max_depth': [10, 15, 20], 'max_features': ['sqrt', 'log2'], 'n_estimators': [3, 5, 9]}, model_name='sklearn.ensemble.RandomForestClassifier')]
[ 2025-01-15 14:32:07,210 ] 106 neuro_mf - INFO - ('**************************************************', 'training KNeighborsClassifier', '**************************************************')
[ 2025-01-15 14:32:07,210 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-15 14:32:27,180 ] 106 neuro_mf - INFO - ('**************************************************', 'training RandomForestClassifier', '**************************************************')
[ 2025-01-15 14:32:27,180 ] 59 neuro_mf - INFO - {'cv': 3, 'verbose': 3}
[ 2025-01-15 14:32:30,746 ] 223 neuro_mf - INFO - Acceptable model found:GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9558812962563771)
[ 2025-01-15 14:32:30,747 ] 229 neuro_mf - INFO - Best model: GridSearchedBestModel(model_serial_number='module_0', model=KNeighborsClassifier(algorithm='kd_tree', n_neighbors=3), best_model=KNeighborsClassifier(n_neighbors=3, weights='distance'), best_parameters={'algorithm': 'auto', 'n_neighbors': 3, 'weights': 'distance'}, best_score=0.9558812962563771)
[ 2025-01-15 14:32:30,805 ] 37 root - INFO - Entered the load object method of Utils
[ 2025-01-15 14:32:30,805 ] 41 root - INFO - Exited the load object from the method utils
[ 2025-01-15 14:32:30,805 ] 85 root - INFO - Created usvisa model object with preprocessor and model
[ 2025-01-15 14:32:30,805 ] 86 root - INFO - Created best model file path.
[ 2025-01-15 14:32:30,805 ] 68 root - INFO - Enter the save method object of the utils
[ 2025-01-15 14:32:30,809 ] 77 root - INFO - Exited the save object from the utils
[ 2025-01-15 14:32:30,809 ] 93 root - INFO - Model trainer artifact: ModelTrainerArtifact(trained_model_file_path='artifact/01_15_2025_14_31_54/model_trainer/trained_model/model.pkl', metric_artifact=ClassificationMetricArtifact(f1_score=0.8130896226415094, precision_score=0.8434250764525993, recall_score=0.7848605577689243))
[ 2025-01-15 14:32:30,809 ] 63 root - INFO - Model training completed successfully.
[ 2025-01-15 14:32:30,809 ] 92 root - INFO - Training pipeline completed successfully.
